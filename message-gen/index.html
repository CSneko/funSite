<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¶£å‘³ç•™è¨€ç”Ÿæˆå™¨</title>
    <style>
        /* åŸºç¡€é€šç”¨æ ·å¼ */
        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; transition: background-color 0.5s; }
        .hidden { display: none !important; }
        
        /* ---------------- ç”Ÿæˆå™¨ç•Œé¢æ ·å¼ ---------------- */
        #generator-ui { padding: 40px; max-width: 600px; margin: 0 auto; display: flex; flex-direction: column; gap: 20px; background: #f9f9f9; min-height: 100vh; box-sizing: border-box;}
        h1 { text-align: center; color: #333; }
        textarea { width: 100%; height: 150px; padding: 15px; border: 2px solid #ddd; border-radius: 10px; font-size: 16px; resize: none; box-sizing: border-box;}
        select, button { padding: 12px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; cursor: pointer; }
        button { background-color: #4CAF50; color: white; border: none; font-weight: bold; transition: background 0.3s; }
        button:hover { background-color: #45a049; }
        #result-box { margin-top: 20px; padding: 15px; background: #e8f5e9; border-left: 5px solid #4CAF50; word-break: break-all; }
        #result-link { display: block; margin-bottom: 10px; color: #2e7d32; text-decoration: none; font-weight: bold;}
        #result-link:hover { text-decoration: underline; }

        /* ---------------- å±•ç¤ºç•Œé¢åŠ¨ç”»ä¸ä¸»é¢˜ ---------------- */
        #viewer-ui { height: 100vh; display: flex; justify-content: center; align-items: center; text-align: center; padding: 20px; box-sizing: border-box; overflow: hidden; position: relative;}
        
        /* å¼€åœºåŠ¨ç”»é®ç½© */
        #intro-animation { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #222; z-index: 10; display: flex; justify-content: center; align-items: center; color: white; font-size: 24px; font-weight: bold; transition: opacity 0.8s ease-out; }
        .spin { animation: spinCounter 1.5s ease-in-out forwards; }
        @keyframes spinCounter {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(360deg); opacity: 1; }
            100% { transform: scale(1) rotate(720deg); opacity: 0; }
        }

        #view-content { opacity: 0; transition: opacity 1s ease-in; max-width: 800px;}
        .show-content { opacity: 1 !important; transform: scale(1); }

        /* ä¸»é¢˜ 1ï¼šå¯çˆ±é£ (Cute) */
        body.theme-cute { background: #ffe4e1; }
        .theme-cute #view-content { font-family: 'Comic Sans MS', 'Microsoft YaHei', cursive; color: #ff69b4; font-size: 32px; background: rgba(255, 255, 255, 0.7); padding: 40px; border-radius: 30px; box-shadow: 0 10px 20px rgba(255, 105, 180, 0.2); border: 3px dashed #ffb6c1; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

        /* ä¸»é¢˜ 2ï¼šæå®¢é£ (Geek) */
        body.theme-geek { background: #000; }
        .theme-geek #view-content { font-family: 'Courier New', Courier, monospace; color: #0f0; font-size: 24px; text-align: left; text-shadow: 0 0 5px #0f0; position: relative; }
        .theme-geek #view-content::after { content: '|'; animation: blink 1s step-end infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        /* ä¸»é¢˜ 3ï¼šæç¬‘é£ (Funny) */
        body.theme-funny { background: #ffeb3b; }
        .theme-funny #view-content { font-family: 'Impact', 'é»‘ä½“', sans-serif; color: #f44336; font-size: 50px; text-transform: uppercase; -webkit-text-stroke: 2px #000; text-shadow: 5px 5px 0 #000; animation: shake 0.5s infinite; }
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-2deg); }
            20% { transform: translate(-3px, 0px) rotate(2deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(2deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-2deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
    </style>
</head>
<body>

    <!-- ================== ç”Ÿæˆå™¨éƒ¨åˆ† ================== -->
    <div id="generator-ui">
        <h1>âœ¨ è¶£å‘³ç•™è¨€ç”Ÿæˆå™¨</h1>
        <p>è¾“å…¥ä½ æƒ³è¯´çš„è¯ï¼Œé€‰ä¸ªé…·ç‚«çš„é£æ ¼ï¼Œç”Ÿæˆä¸“å±é“¾æ¥å‘ç»™æœ‹å‹ï¼</p>
        <textarea id="input-text" placeholder="åœ¨è¿™é‡Œè¾“å…¥è¦å¯¹æœ‹å‹è¯´çš„æ‚„æ‚„è¯..."></textarea>
        
        <label for="style-select">é€‰æ‹©é¡µé¢é£æ ¼ï¼š</label>
        <select id="style-select">
            <option value="cute">ğŸ’– å¯çˆ±é£</option>
            <option value="geek">ğŸ’» æå®¢é£</option>
            <option value="funny">ğŸ¤ª æç¬‘é£</option>
        </select>
        
        <button onclick="generateLink()">ç”Ÿæˆé­”æ³•é“¾æ¥</button>

        <div id="result-box" class="hidden">
            <p>ç”ŸæˆæˆåŠŸï¼ç‚¹å‡»é“¾æ¥æˆ–å¤åˆ¶å‘ç»™æœ‹å‹ï¼š</p>
            <a id="result-link" href="#" target="_blank"></a>
            <button onclick="copyLink()" style="font-size: 14px; padding: 8px;">ğŸ“‹ å¤åˆ¶é“¾æ¥</button>
        </div>
    </div>

    <!-- ================== å±•ç¤ºé¡µéƒ¨åˆ† ================== -->
    <div id="viewer-ui" class="hidden">
        <!-- åŠ è½½åŠ¨ç”»å±‚ -->
        <div id="intro-animation">
            <div id="intro-icon">ğŸ”® è§£æå‚æ•°ä¸­...</div>
        </div>
        <!-- çœŸæ­£çš„å†…å®¹å±‚ -->
        <div id="view-content"></div>
    </div>

    <script>
        // --- ç®€æ˜“åŠ å¯†ä¸è§£å¯†å‡½æ•° (Base64 + URIEncode) ---
        function encrypt(text) {
            // btoa å¯ä»¥å°†å­—ç¬¦ä¸²è½¬ä¸º Base64ï¼Œä½†ä¸æ”¯æŒä¸­æ–‡ï¼Œéœ€è¦å…ˆç”¨ encodeURIComponent
            return btoa(encodeURIComponent(text));
        }

        function decrypt(encodedText) {
            try {
                return decodeURIComponent(atob(encodedText));
            } catch (e) {
                return "æ–‡æœ¬è§£å¯†å¤±è´¥ï¼å¯èƒ½é“¾æ¥è¢«ç ´åäº†ã€‚";
            }
        }

        // --- è·¯ç”±é€»è¾‘åˆ¤æ–­ ---
        const urlParams = new URLSearchParams(window.location.search);
        const encodedText = urlParams.get('text');
        const style = urlParams.get('style');

        if (encodedText && style) {
            // å¸¦æœ‰å‚æ•° -> æ˜¾ç¤ºå±•ç¤ºé¡µ
            document.getElementById('generator-ui').classList.add('hidden');
            document.getElementById('viewer-ui').classList.remove('hidden');
            
            // è§£ææ–‡æœ¬ä¸åº”ç”¨æ ·å¼
            const plainText = decrypt(encodedText);
            const contentDiv = document.getElementById('view-content');
            
            document.body.className = 'theme-' + style; // è®¾ç½®èƒŒæ™¯ä¸»é¢˜

            // æå®¢é£ç‰¹æ®Šå¤„ç†ï¼ˆæ‰“å­—æœºæ•ˆæœæ¨¡æ‹Ÿï¼‰
            if (style === 'geek') {
                contentDiv.innerHTML = "root@system:~$ decrypting...<br>" + plainText.replace(/\n/g, '<br>');
            } else if (style === 'cute') {
                contentDiv.innerHTML = "âœ¨ " + plainText.replace(/\n/g, '<br>') + " âœ¨";
            } else {
                contentDiv.innerHTML = plainText.replace(/\n/g, '<br>');
            }

            // è§¦å‘å¼€åœºåŠ¨ç”»
            const intro = document.getElementById('intro-animation');
            const icon = document.getElementById('intro-icon');
            icon.classList.add('spin');

            // åŠ¨ç”»ç»“æŸåæ˜¾ç¤ºå†…å®¹
            setTimeout(() => {
                intro.style.opacity = '0';
                setTimeout(() => {
                    intro.classList.add('hidden');
                    contentDiv.classList.add('show-content');
                }, 800);
            }, 1000);

        } else {
            // æ²¡æœ‰å‚æ•° -> æ˜¾ç¤ºç”Ÿæˆå™¨ï¼Œæ— éœ€éšè—æ“ä½œå› ä¸ºä¸€å¼€å§‹å°±æ˜¯æ˜¾ç¤ºç”Ÿæˆçš„
        }

        // --- æŒ‰é’®äº‹ä»¶å¤„ç† ---
        function generateLink() {
            const text = document.getElementById('input-text').value;
            if (!text.trim()) {
                alert("è¯·è¾“å…¥ä¸€äº›æ–‡æœ¬å“¦ï¼");
                return;
            }
            const style = document.getElementById('style-select').value;
            const encrypted = encrypt(text);
            
            // æ„å»ºå¸¦å‚æ•°çš„ URL
            const baseUrl = window.location.href.split('?')[0];
            const finalUrl = `${baseUrl}?text=${encrypted}&style=${style}`;
            
            const linkTag = document.getElementById('result-link');
            linkTag.href = finalUrl;
            linkTag.innerText = finalUrl;
            
            document.getElementById('result-box').classList.remove('hidden');
        }

        function copyLink() {
            const linkText = document.getElementById('result-link').innerText;
            navigator.clipboard.writeText(linkText).then(() => {
                alert("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼");
            }).catch(err => {
                alert("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰å–å¤åˆ¶ã€‚");
            });
        }
    </script>
</body>
</html>